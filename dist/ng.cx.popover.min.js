/**********************************************************
 * 
 * ng.cx.popover - v0.0.3
 * 
 * Release date : 2016-01-08 : 10:57
 * Author       : Jaime Beneytez - EF CTX 
 * License      : MIT 
 * 
 **********************************************************/



!function(a){"use strict";a.module("ng.cx.popover",["ng.cx.popover.trigger","ng.cx.popover.popover","ng.cx.popover.service"]),a.module("ng.cx.popover.popover",["ngAnimate","ng.cx.popover.service"]).directive("cxPopover",[function(){return{replace:"element",transclude:!0,template:'<div class="cx-popover" ng-show="isVisible" ng-class="{\'visible\':isVisible}"><div class="arrow"></div><div ng-transclude></div></div>',scope:{},bindToController:{ioPopoverId:"@cxPopoverIoPopoverId"},controller:"cxPopoverController as cxPopoverController"}}]).controller("cxPopoverController",["$scope","$document","$element","$animate","cxPopoverService",function(a,b,c,d,e){function f(){e.registrerPopover(m),b.find("body").append(c),a.$applyAsync(g)}function g(){c.css("opacity","0"),l=c[0].getBoundingClientRect(),c.css("opacity",null)}function h(b,d){c.addClass(d),j(b,d),o=!0,a.$applyAsync()}function i(){o=!1,j(),a.$evalAsync()}function j(a,b){function e(a){c.css("top",a.top),c.css("left",a.left)}a&&b?e(k(a,b)):d.on("addClass",c,e)}function k(a,b){var c,d,e=a[0].getBoundingClientRect(),f=l;switch(b){case"right":c=e.top+e.height/2-f.height/2,d=e.left+e.width;break;case"left":c=e.top+e.height/2-f.height/2,d=e.left-f.width;break;case"top":d=e.left+e.width/2-f.width/2,c=e.top-f.height;break;case"bottom":d=e.left+e.width/2-f.width/2,c=e.top+e.height}return{top:c+"px",left:d+"px"}}var l,m=this,n=this.ioPopoverId,o=!1;this.show=h,this.hide=i,Object.defineProperty(a,"isVisible",{get:function(){return o}}),Object.defineProperty(m,"isVisible",{get:function(){return o}}),Object.defineProperty(m,"popoverId",{get:function(){return n}}),f()}]),a.module("ng.cx.popover.service",["ngAnimate"]).service("cxPopoverService",[function(){function a(a){d[a.popoverId]=a}function b(a){return d[a]}function c(){for(var a in d)d[a].hide()}var d={};this.registrerPopover=a,this.getPopoverById=b,this.hideAll=c}]),a.module("ng.cx.popover.trigger",["ngAnimate","ng.cx.popover.service"]).directive("cxPopoverTrigger",["$document",function(a){return{scope:{},bindToController:{ioPopoverId:"@cxPopoverTriggerIoPopoverId",ioPlacement:"@?cxPopoverTriggerIoPlacement",ioEvent:"@?cxPopoverTriggerIoEvent",ioEnabled:"=?cxPopoverTriggerIoEnabled"},controller:"cxPopoverTriggerController as cxPopoverTriggerController"}}]).controller("cxPopoverTriggerController",["$scope","$document","$element","cxPopoverService",function(b,c,d,e){function f(){i(p.ioEvent)}function g(){p.ioEnabled&&(e.hideAll(),o.show(d,p.ioPlacement))}function h(){o.hide()}function i(){switch(p.ioEvent){case"mouseenter":j(g),l();break;case"click":j(m)}}function j(a){n=a,d.on(p.ioEvent,k)}function k(a){o=e.getPopoverById(q),d.off(p.ioEvent,k),d.on(p.ioEvent,n),n(a)}function l(){d.on("mouseleave",h),d.on("click",h)}function m(a){a.stopImmediatePropagation(),o.isVisible?(c.off("click",h),h()):(c.on("click",h),g())}var n,o,p=this,q=this.ioPopoverId;p.ioEnabled=a.isDefined(p.ioEnabled)?p.ioEnabled:!0,p.ioEvent=p.ioEvent||"mouseenter",p.ioPlacement=p.ioPlacement||"right",f()}])}(angular);